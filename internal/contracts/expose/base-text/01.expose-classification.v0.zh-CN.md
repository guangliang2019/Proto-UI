# Expose 分类与 API（v0）

> Status: Draft – v0
>
> v0 需要区分 expose 的语义类别，以便 adapter 做稳定映射。该分类不改变 expose 的注册式本质，只补充语义分层与 API 入口。

---

## 1. 分类

Expose v0 定义以下语义类别：

1. **event**：组件对外通知的事件通路（组件 → App Maker）
2. **state**：对外可读状态 handle（expose-state）
3. **value**：只读常量/配置输出
4. **method**：命令式 API（imperative）

---

## 2. API 形态（setup-only）

### 2.1 基础形式

```ts
def.expose<K extends keyof E>(key: K, value: E[K]): void
```

### 2.2 分类形式（新增）

```ts
def.expose.event<K extends string>(key: K, spec: ExposeEventSpec): void

def.expose.state<K extends string>(key: K, handle: InternalStateHandleView): void

def.expose.value<K extends string, V>(key: K, value: V): void

def.expose.method<K extends string, F extends Function>(key: K, fn: F): void
```

> 以上 API 仅改变注册语义与 adapter 映射，不改变 setup-only 与生命周期规则。

---

## 3. 语义规则

- `event`：只声明对外事件通路，与 event 模块绑定（见 expose-event）
- `state`：等价于 `def.expose(key, stateHandle)` 并附加 expose-state 语义
- `value`：等价于 `def.expose(key, value)` 的只读语义
- `method`：等价于 `def.expose(key, fn)` 的命令式语义

---

## 4. Adapter 映射（概览）

- React：
  - event → props callback
  - method → ref/instance method
  - state → external state handle
  - value → props or static expose map

- Vue：
  - event → emits
  - method → expose (via `expose()`)
  - state/value → expose map

- WebComponent：
  - event → CustomEvent
  - method/state/value → instance properties or methods

> 具体映射策略由 adapter 契约细化。

---

## 5. 错误模型

- 所有分类 API 继承 `def.expose` 的错误模型
- `event` 分类若未绑定 event 模块能力，必须报错（见 expose-event）
